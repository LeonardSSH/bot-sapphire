{"version":3,"file":"Prefix.js","sourceRoot":"","sources":["file:///C:/Users/Quantumly/Documents/Development/Projects/PenguBot/bot/src/lib/structures/Prefix.ts"],"names":[],"mappings":";;;AACA,iDAA8C;AAE9C,MAAa,MAAM;IAEE,MAAM,CAAc;IAErC,YAAmB,MAAmB;QAClC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACzB,CAAC;IAEM,KAAK,CAAC,YAAY,CAAC,EAAU;QAChC,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,UAAU,GAAG,EAAE,EAAE,CAAC,CAAC;QACxE,IAAI,MAAM,KAAK,IAAI;YAAE,OAAO,MAAM,CAAC;QACnC,OAAO,IAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;IACtC,CAAC;IAEM,KAAK,CAAC,iBAAiB,CAAC,EAAU;QACrC,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,aAAK,CAAC,OAAO,EAAE,CAAC;QACzC,MAAM,QAAQ,GAAG,MAAM,MAAM,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;QACzC,MAAM,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,UAAU,GAAG,EAAE,EAAE,EAAE,QAAQ,CAAC,MAAM,CAAC,CAAC;QAC1E,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;QACtB,OAAO,QAAQ,CAAC,MAAM,CAAC;IAC3B,CAAC;IAGM,MAAM,CAAU,UAAU,GAAG,eAAe,CAAC;;AAvBxD,wBAyBC","sourcesContent":["import { PenguClient } from \"@lib/PenguClient\";\nimport { DbSet } from \"@lib/structures/DBSet\";\n\nexport class Prefix {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    private readonly client: PenguClient;\n\n    public constructor(client: PenguClient) {\n        this.client = client;\n    }\n\n    public async ensurePrefix(id: string) {\n        const prefix = await this.client.redis.get(`${Prefix.KEY_PREFIX}${id}`);\n        if (prefix !== null) return prefix;\n        return this.ensurePrefixCache(id);\n    }\n\n    public async ensurePrefixCache(id: string) {\n        const { guilds } = await DbSet.connect();\n        const settings = await guilds.ensure(id);\n        await this.client.redis.set(`${Prefix.KEY_PREFIX}${id}`, settings.prefix);\n        await settings.save();\n        return settings.prefix;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    public static readonly KEY_PREFIX = \"guild_prefix_\";\n\n}\n"]}