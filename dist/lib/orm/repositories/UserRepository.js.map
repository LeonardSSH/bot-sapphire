{"version":3,"file":"UserRepository.js","sourceRoot":"","sources":["../../../../src/lib/orm/repositories/UserRepository.ts"],"names":[],"mappings":";;;;AAAA,yDAAsD;AACtD,qCAAuE;AACvE,iDAA8C;AAC9C,uEAAoE;AAIpE,IAAa,cAAc,GAA3B,MAAa,cAAe,SAAQ,oBAAsB;IAC/C,KAAK,CAAC,MAAM,CAAC,EAAU,EAAE,OAAoC;QACtE,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;QACjD,IAAI,QAAQ;YAAE,OAAO,QAAQ,CAAC;QAE9B,MAAM,IAAI,GAAG,IAAI,uBAAU,EAAE,CAAC;QAC9B,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;QACb,OAAO,IAAI,CAAC;IACb,CAAC;IAEM,KAAK,CAAC,YAAY,CAAI,QAAgB,EAAE,IAAU;QACxD,MAAM,EAAE,mBAAmB,EAAE,GAAG,MAAM,aAAK,CAAC,OAAO,EAAE,CAAC;QAEtD,IAAI,aAAa,GAAG,CAAC,MAAM,mBAAmB,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,EAAE,CAAC,CAAyB,CAAC;QACtI,IAAI,aAAa;YAAE,OAAO,aAAa,CAAC;QAExC,aAAa,GAAG,IAAI,qCAAiB,EAAK,CAAC;QAC3C,aAAa,CAAC,IAAI,GAAG,QAAQ,CAAC;QAC9B,aAAa,CAAC,IAAI,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAEhD,OAAO,aAAa,CAAC;IACtB,CAAC;CACD,CAAA;AAtBY,cAAc;IAD1B,0BAAgB,CAAC,uBAAU,CAAC;GAChB,cAAc,CAsB1B;AAtBY,wCAAc","sourcesContent":["import { UserEntity } from \"@orm/entities/UserEntity\";\nimport { EntityRepository, FindOneOptions, Repository } from \"typeorm\";\nimport { DbSet } from \"@lib/structures/DbSet\";\nimport { UserGametagEntity } from \"@orm/entities/UserGametagEntity\";\nimport { User } from \"discord.js\";\n\n@EntityRepository(UserEntity)\nexport class UserRepository extends Repository<UserEntity> {\n    public async ensure(id: string, options?: FindOneOptions<UserEntity>) {\n\t\tconst previous = await this.findOne(id, options);\n\t\tif (previous) return previous;\n\n\t\tconst data = new UserEntity();\n\t\tdata.id = id;\n\t\treturn data;\n\t}\n\n\tpublic async fetchGametag<T>(gameName: string, user: User): Promise<UserGametagEntity<T>> {\n\t\tconst { userGametagEntities } = await DbSet.connect();\n\n\t\tlet gametagEntity = (await userGametagEntities.findOne({ where: { user: { id: user.id }, game: gameName } })) as UserGametagEntity<T>;\n\t\tif (gametagEntity) return gametagEntity;\n\n\t\tgametagEntity = new UserGametagEntity<T>();\n\t\tgametagEntity.game = gameName;\n\t\tgametagEntity.user = await this.ensure(user.id);\n\n\t\treturn gametagEntity;\n\t}\n}\n"]}